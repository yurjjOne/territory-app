<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–û–±–ª—ñ–∫ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ–π</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    .taken-row { background-color: #fff4f4; }
    .free-row  { background-color: #f4fff4; }
    .overdue   { background-color: #ffdddd; }
    .toggles { margin-bottom: 20px; }
    .toggles label { margin-right: 20px; cursor: pointer; }
    button { background-color: #c9302c; color: white; border: none; padding: 5px 10px; cursor: pointer; }
    button:hover { background-color: #ac2925; }
  </style>
</head>
<body>
  <h1>–û–±–ª—ñ–∫ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ–π</h1>

  <!-- –ß–µ–∫–±–æ–∫—Å–∏ –¥–ª—è —Å—Ö–æ–≤–∞–Ω–Ω—è/–ø–æ–∫–∞–∑—É —Å–µ–∫—Ü—ñ–π -->
  <div class="toggles">
    <label>
      <input type="checkbox" id="showTaken" checked
             onchange="toggleSection('taken', this.checked)">
      –ü–æ–∫–∞–∑–∞—Ç–∏ "–û–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å"
    </label>
    <label>
      <input type="checkbox" id="showFree" checked
             onchange="toggleSection('free', this.checked)">
      –ü–æ–∫–∞–∑–∞—Ç–∏ "–í—ñ–ª—å–Ω—ñ"
    </label>
  </div>

  <!-- –û–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å (–í–∑—è—Ç–æ) -->
  <h2>üî¥ –û–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å (–í–∑—è—Ç–æ)</h2>
  <table id="taken">
    <tr>
      <th>–ù–æ–º–µ—Ä</th><th>–ù–∞–∑–≤–∞</th><th>–•—Ç–æ –≤–∑—è–≤</th>
      <th>–î–∞—Ç–∞ –≤–∏–¥–∞—á—ñ</th><th>–î–∞—Ç–∞ –∑–¥–∞—á—ñ</th><th>–î—ñ—è</th>
    </tr>
    {% for r, due_flag in taken %}
    <tr class="taken-row">
      <td>{{ r[0] }}</td>
      <td>{{ r[1] }}</td>
      <td>{{ r[3] }}</td>
      <td{% if due_flag %} class="overdue"{% endif %}>{{ r[4] }}</td>
      <td>{{ r[5] or '‚Äî' }}</td>
      <td>
        <a href="{{ url_for('update_territory', territory_id=r[0]) }}">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
        <form method="POST"
              action="{{ url_for('release_territory', territory_id=r[0]) }}"
              style="display:inline">
          <button type="submit">–ó–¥–∞–Ω–æ</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>

  <!-- –í—ñ–ª—å–Ω—ñ -->
  <h2>üü¢ –í—ñ–ª—å–Ω—ñ</h2>
  <table id="free">
    <tr>
      <th>–ù–æ–º–µ—Ä</th><th>–ù–∞–∑–≤–∞</th><th>–î—ñ—è</th>
    </tr>
    {% for r in free %}
    <tr class="free-row">
      <td>{{ r[0] }}</td>
      <td>{{ r[1] }}</td>
      <td>
        <a href="{{ url_for('update_territory', territory_id=r[0]) }}">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
        <form method="POST"
              action="{{ url_for('clear_territory', territory_id=r[0]) }}"
              style="display:inline">
          <button style="background:#aaa">–û—á–∏—Å—Ç–∏—Ç–∏</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>

  <script>
    function toggleSection(id, show) {
      document.getElementById(id).style.display = show ? '' : 'none';
    }
    // –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
    document.addEventListener('DOMContentLoaded', () => {
      toggleSection('taken', document.getElementById('showTaken').checked);
      toggleSection('free', document.getElementById('showFree').checked);
    });
  </script>
</body>
</html>
