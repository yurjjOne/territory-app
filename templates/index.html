<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–û–±–ª—ñ–∫ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ–π</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 40px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        h2 { margin-top: 40px; color: #444; cursor: pointer; }
        .taken-row { background-color: #fff4f4; }
        .free-row  { background-color: #f4fff4; }
        .overdue   { background-color: #ffdddd; }
        form { display: inline; }
        button { background-color: #c9302c; color: white; border: none; padding: 5px 10px; cursor: pointer; }
        button:hover { background-color: #ac2925; }
    </style>
</head>
<body>
    <h1>–û–±–ª—ñ–∫ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ–π</h1>

    <h2 onclick="toggle('taken')">üî¥ –û–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å (–í–∑—è—Ç–æ)</h2>
    <table id="taken">
        <tr>
            <th>–ù–æ–º–µ—Ä</th>
            <th>–ù–∞–∑–≤–∞</th>
            <th>–•—Ç–æ –≤–∑—è–≤</th>
            <th>–î–∞—Ç–∞ –≤–∏–¥–∞—á—ñ</th>
            <th>–î–∞—Ç–∞ –∑–¥–∞—á—ñ</th>
            <th>–î—ñ—è</th>
        </tr>
        {% for r, due_flag in taken %}
        <tr class="taken-row">
            <td>{{ r[0] }}</td>
            <td>{{ r[1] }}</td>
            <td>{{ r[3] or '–ù—ñ—Ö—Ç–æ' }}</td>
            <td{% if due_flag %} class="overdue"{% endif %}>{{ r[4] or '–ù–µ–º–∞—î' }}</td>
            <td>{{ r[5] or '–ù–µ–º–∞—î' }}</td>
            <td>
                <a href="{{ url_for('update_territory', territory_id=r[0]) }}">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
                <form method="POST" action="{{ url_for('release_territory', territory_id=r[0]) }}">
                    <button type="submit">–ó–¥–∞–Ω–æ</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <h2 onclick="toggle('free')">üü¢ –í—ñ–ª—å–Ω—ñ</h2>
    <table id="free">
        <tr>
            <th>–ù–æ–º–µ—Ä</th>
            <th>–ù–∞–∑–≤–∞</th>
            <th>–î—ñ—è</th>
        </tr>
        {% for r in free %}
        <tr class="free-row">
            <td>{{ r[0] }}</td>
            <td>{{ r[1] }}</td>
            <td>
                <a href="{{ url_for('update_territory', territory_id=r[0]) }}">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
                <form method="POST" action="{{ url_for('clear_territory', territory_id=r[0]) }}">
                    <button type="submit" style="background:#aaa;">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <script>
        function toggle(id) {
            const tbl = document.getElementById(id);
            tbl.style.display = tbl.style.display === 'none' ? '' : 'none';
        }
    </script>
</body>
</html>
