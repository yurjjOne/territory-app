<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–¢–µ—Ä–∏—Ç–æ—Ä—ñ—ó</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="container">
    <div class="header-actions">
      <h1>–¢–µ—Ä–∏—Ç–æ—Ä—ñ—ó</h1>
      <a href="{{ url_for('login') }}" class="btn btn-secondary">–í–∏–π—Ç–∏</a>
    </div>

    <div class="section">
      <h2 class="section-title">
        –í–∑—è—Ç—ñ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ—ó ({{ taken|length }})
        <div class="toggle" id="toggleTaken"></div>
      </h2>
      <div class="territory-grid" id="takenGrid">
        {% for territory, is_overdue in taken %}
        <div class="territory-card taken {% if is_overdue %}overdue{% endif %}">
          <div class="territory-number">{{ territory[0] }}</div>
          <h3>{{ territory[1] }}</h3>
          <div class="territory-info">
            <p><strong>üë§ –í–∑—è—Ç–æ:</strong> {{ territory[3] }}</p>
            <p><strong>üìÖ –î–∞—Ç–∞ –≤–∏–¥–∞—á—ñ:</strong> {{ territory[4] }}</p>
            <p><strong>üìÜ –ü–ª–∞–Ω–æ–≤–∞ –¥–∞—Ç–∞ –∑–¥–∞—á—ñ:</strong> 
              <span {% if is_overdue %}class="overdue-date"{% endif %}>
                {{ territory[5] }}
              </span>
            </p>
            {% if not is_admin and territory[6] %}
            <div class="territory-notes">
              <strong>üìù –ü—Ä–∏–º—ñ—Ç–∫–∏:</strong><br>
              {{ territory[6] }}
            </div>
            {% endif %}
          </div>
          {% if is_admin %}
          <div class="button-group">
            <form action="{{ url_for('release_territory', territory_id=territory[0]) }}" method="POST" style="display: inline;">
              <button type="submit" class="btn btn-danger">–ó–≤—ñ–ª—å–Ω–∏—Ç–∏</button>
            </form>
            <a href="{{ url_for('update_territory', territory_id=territory[0]) }}" class="btn btn-primary">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
          </div>
          {% else %}
          <a href="{{ url_for('update_territory', territory_id=territory[0]) }}" class="btn btn-secondary">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</a>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>

    <div class="section">
      <h2 class="section-title">
        –í—ñ–ª—å–Ω—ñ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ—ó ({{ free|length }})
        <div class="toggle" id="toggleFree"></div>
      </h2>
      <div class="territory-grid" id="freeGrid">
        {% for territory in free %}
        <div class="territory-card free">
          <div class="territory-number">{{ territory[0] }}</div>
          <h3>{{ territory[1] }}</h3>
          <div class="territory-info">
            <p><strong>üìã –°—Ç–∞—Ç—É—Å:</strong> {{ territory[2] }}</p>
            {% if not is_admin and territory[6] %}
            <div class="territory-notes">
              <strong>üìù –ü—Ä–∏–º—ñ—Ç–∫–∏:</strong><br>
              {{ territory[6] }}
            </div>
            {% endif %}
          </div>
          {% if is_admin %}
          <a href="{{ url_for('update_territory', territory_id=territory[0]) }}" class="btn btn-primary">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
          {% else %}
          <a href="{{ url_for('update_territory', territory_id=territory[0]) }}" class="btn btn-secondary">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</a>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <script>
    document.getElementById('toggleTaken').addEventListener('click', function() {
      this.classList.toggle('inactive');
      document.getElementById('takenGrid').classList.toggle('hidden');
    });

    document.getElementById('toggleFree').addEventListener('click', function() {
      this.classList.toggle('inactive');
      document.getElementById('freeGrid').classList.toggle('hidden');
    });
  </script>
</body>
</html>
